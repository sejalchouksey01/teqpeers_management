<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card shadow-lg border-0 rounded-lg">
        <div class="card-header bg-primary text-white py-3">
          <h4 class="card-title mb-0">
            <i class="fas fa-user-plus me-2"></i>
            Create New User
          </h4>
        </div>
        
        <div class="card-body bg-light">
          <%= form_for @user, url: create_user_path, method: :post, html: { class: 'needs-validation', novalidate: true } do |f| %>
            <% if @user.errors.any? %>
              <div class="alert alert-danger">
                <h5><i class="fas fa-exclamation-triangle me-2"></i>Please fix the following errors:</h5>
                <ul>
                  <% @user.errors.full_messages.each do |message| %>
                    <li><%= message %></li>
                  <% end %>
                </ul>
              </div>
            <% end %>

            <div class="row g-4">
              <!-- Email Field -->
              <div class="col-md-12">
                <div class="form-floating">
                  <%= f.email_field :email, 
                      class: 'form-control',
                      placeholder: 'Email',
                      required: true %>
                  <%= f.label :email, class: 'required-label' %>
                  <div class="invalid-feedback">
                    Please provide a valid email address.
                  </div>
                </div>
              </div>

              <!-- Password Field -->
              <div class="col-md-6">
                <div class="form-floating password-field">
                  <%= f.password_field :password,
                      class: 'form-control',
                      placeholder: 'Password' %>
                  <%= f.label :password %>
                  <i class="fas fa-eye password-toggle"></i>
                </div>
              </div>

              <!-- Password Confirmation Field -->
              <div class="col-md-6">
                <div class="form-floating password-field">
                  <%= f.password_field :password_confirmation,
                      class: 'form-control',
                      placeholder: 'Confirm Password' %>
                  <%= f.label :password_confirmation, 'Confirm Password' %>
                  <i class="fas fa-eye password-toggle"></i>
                </div>
              </div>

              <!-- First Name Field -->
              <div class="col-md-6">
                <div class="form-floating">
                  <%= f.text_field :first_name, 
                      class: 'form-control',
                      placeholder: 'First Name',
                      required: true %>
                  <%= f.label :first_name, class: 'required-label' %>
                  <div class="invalid-feedback">
                    First name is required.
                  </div>
                </div>
              </div>

              <!-- Last Name Field -->
              <div class="col-md-6">
                <div class="form-floating">
                  <%= f.text_field :last_name, 
                      class: 'form-control',
                      placeholder: 'Last Name',
                      required: true %>
                  <%= f.label :last_name, class: 'required-label' %>
                  <div class="invalid-feedback">
                    Last name is required.
                  </div>
                </div>
              </div>

              <!-- Phone Number Field -->
              <div class="col-md-6">
                <div class="form-floating">
                  <%= f.telephone_field :phone_number, 
                      class: 'form-control',
                      placeholder: 'Phone Number' %>
                  <%= f.label :phone_number %>
                </div>
              </div>

              <!-- Role Selection -->
              <div class="col-md-6">
                <div class="form-floating">
                  <%= f.select :role, 
                      options_for_select([
                        ['Select Role', ''],
                        ['Mentor', 'mentor'],
                        ['Trainee', 'trainee']
                      ]), 
                      {},
                      { class: 'form-select', required: true } %>
                  <%= f.label :role, class: 'required-label' %>
                  <div class="invalid-feedback">
                    Please select a role.
                  </div>
                </div>
              </div>

              <!-- Address Field -->
              <div class="col-12">
                <div class="form-floating">
                  <%= f.text_area :address, 
                      class: 'form-control',
                      placeholder: 'Address',
                      style: 'height: 100px' %>
                  <%= f.label :address %>
                </div>
              </div>
            </div>

            <!-- Submit Button -->
            <div class="mt-4 text-center">
              <%= f.submit 'Create User', 
                  class: 'btn btn-primary btn-lg rounded-pill px-5 py-2 submit-btn',
                  data: { disable_with: 'Creating...' } %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// Form validation
(function () {
  'use strict'

  // Fetch all forms that need validation
  var forms = document.querySelectorAll('.needs-validation')

  // Loop over them and prevent submission
  Array.prototype.slice.call(forms)
    .forEach(function (form) {
      form.addEventListener('submit', function (event) {
        if (!form.checkValidity()) {
          event.preventDefault()
          event.stopPropagation()
        }

        form.classList.add('was-validated')
      }, false)
    })

  // Password visibility toggle
  document.querySelectorAll('.password-toggle').forEach(function(toggle) {
    toggle.addEventListener('click', function() {
      var passwordField = this.previousElementSibling
      if (passwordField.type === 'password') {
        passwordField.type = 'text'
        this.classList.remove('fa-eye')
        this.classList.add('fa-eye-slash')
      } else {
        passwordField.type = 'password'
        this.classList.remove('fa-eye-slash')
        this.classList.add('fa-eye')
      }
    })
  })
})()
</script>
